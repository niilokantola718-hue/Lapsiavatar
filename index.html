<!DOCTYPE html>
<html lang="fi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lapsen Huone VR</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background: #000;
        }
        #ui {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            background: rgba(0,0,0,0.85);
            color: white;
            font-family: -apple-system, BlinkMacSystemFont, sans-serif;
        }
        button {
            padding: 20px 40px;
            font-size: 24px;
            border-radius: 20px;
            border: none;
            background: linear-gradient(45deg, #FF6B6B, #4ECDC4);
            color: white;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div id="ui">
        <button id="startButton">Käynnistä lapsen huone - VR</button>
        <p>Valmistaudu astumaan 6-vuotiaan perspektiiviin</p>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script>
        let scene, camera, renderer;

        async function init() {
            scene = new THREE.Scene();
            scene.background = new THREE.Color(0xbfd1e5); // pehmeä tausta

            // Kamera 6-vuotiaan korkeudella
            camera = new THREE.PerspectiveCamera(50, window.innerWidth / window.innerHeight, 0.1, 100);
            camera.position.set(0, 1.1, 2.5); // silmien korkeus 1.1 m, hieman etäisyyttä

            // Renderer
            renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.xr.enabled = true;
            document.body.appendChild(renderer.domElement);

            // Valot
            const ambient = new THREE.AmbientLight(0xffffff, 0.8);
            scene.add(ambient);
            const directional = new THREE.DirectionalLight(0xfff5d6, 0.7);
            directional.position.set(3, 5, 2);
            scene.add(directional);

            // Huone (seinät ja lattia)
            const room = new THREE.Group();
            const roomMaterial = new THREE.MeshLambertMaterial({ color: 0xf2f2f2 });
            const wallThickness = 0.1;

            const floor = new THREE.Mesh(new THREE.BoxGeometry(5, wallThickness, 5), new THREE.MeshLambertMaterial({ color: 0xd2b48c }));
            floor.position.y = 0;
            room.add(floor);

            const ceiling = new THREE.Mesh(new THREE.BoxGeometry(5, wallThickness, 5), roomMaterial);
            ceiling.position.y = 2.5;
            room.add(ceiling);

            const wall1 = new THREE.Mesh(new THREE.BoxGeometry(5, 2.5, wallThickness), roomMaterial);
            wall1.position.z = -2.5;
            wall1.position.y = 1.25;
            room.add(wall1);

            const wall2 = wall1.clone();
            wall2.position.z = 2.5;
            room.add(wall2);

            const wall3 = new THREE.Mesh(new THREE.BoxGeometry(wallThickness, 2.5, 5), roomMaterial);
            wall3.position.x = -2.5;
            wall3.position.y = 1.25;
            room.add(wall3);

            const wall4 = wall3.clone();
            wall4.position.x = 2.5;
            room.add(wall4);

            scene.add(room);

            // Pöytä
            const table = new THREE.Mesh(new THREE.BoxGeometry(1, 0.05, 0.6), new THREE.MeshLambertMaterial({ color: 0xdeb887 }));
            table.position.set(0, 0.55, 0);
            scene.add(table);

            const tableLegMaterial = new THREE.MeshLambertMaterial({ color: 0x8b5a2b });
            for (let i = -1; i <= 1; i += 2) {
                for (let j = -1; j <= 1; j += 2) {
                    const leg = new THREE.Mesh(new THREE.BoxGeometry(0.05, 0.5, 0.05), tableLegMaterial);
                    leg.position.set(0.45 * i, 0.25, 0.25 * j);
                    scene.add(leg);
                }
            }

            // Tuolit
            function createChair(x, z) {
                const chair = new THREE.Group();
                const seat = new THREE.Mesh(new THREE.BoxGeometry(0.4, 0.05, 0.4), new THREE.MeshLambertMaterial({ color: 0xcd853f }));
                seat.position.y = 0.3;
                chair.add(seat);
                const back = new THREE.Mesh(new THREE.BoxGeometry(0.4, 0.4, 0.05), new THREE.MeshLambertMaterial({ color: 0x8b4513 }));
                back.position.set(0, 0.55, -0.175);
                chair.add(back);
                chair.position.set(x, 0, z);
                scene.add(chair);
            }
            createChair(-0.8, 0);
            createChair(0.8, 0);

            // Kaappi
            const cabinet = new THREE.Mesh(new THREE.BoxGeometry(1.2, 1.5, 0.4), new THREE.MeshLambertMaterial({ color: 0x9c661f }));
            cabinet.position.set(-1.5, 0.75, -2);
            scene.add(cabinet);

            // Sänky
            const bed = new THREE.Group();
            const mattress = new THREE.Mesh(new THREE.BoxGeometry(1.8, 0.2, 0.8), new THREE.MeshLambertMaterial({ color: 0x87ceeb }));
            mattress.position.y = 0.4;
            bed.add(mattress);
            const frame = new THREE.Mesh(new THREE.BoxGeometry(1.9, 0.1, 0.9), new THREE.MeshLambertMaterial({ color: 0x8b4513 }));
            frame.position.y = 0.35;
            bed.add(frame);
            bed.position.set(1.5, 0, -1.5);
            scene.add(bed);

            // "Ikkuna" valoefekti
            const windowLight = new THREE.PointLight(0xffffff, 0.5, 10);
            windowLight.position.set(-2.4, 1.5, -2.4);
            scene.add(windowLight);

            // Käynnistyspainike
            document.getElementById('startButton').addEventListener('click', startVR);
        }

        async function startVR() {
            const sessionInit = { optionalFeatures: [] };
            try {
                const session = await navigator.xr.requestSession('immersive-vr', sessionInit);
                renderer.xr.setSession(session);
                document.getElementById('ui').style.display = 'none';
                renderer.setAnimationLoop(() => renderer.render(scene, camera));
            } catch (e) {
                alert("VR-sessiota ei voitu käynnistää: " + e.message);
            }
        }

        window.addEventListener('load', init);
    </script>
</body>
</html>
